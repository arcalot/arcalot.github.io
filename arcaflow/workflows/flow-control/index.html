
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://arcalot.io/arcaflow/workflows/flow-control/">
      
      
        <link rel="prev" href="../expressions/">
      
      
        <link rel="next" href="../output/">
      
      
      <link rel="icon" href="../../../arcalot.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.48">
    
    
      
        <title>Flow Control - Arcalot</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.6f8fc17f.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
    
    
      <link rel="stylesheet" href="../../../extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#using-flow-control-mechanics" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Arcalot" class="md-header__button md-logo" aria-label="Arcalot" data-md-component="logo">
      
  <img src="../../../arcalot.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Arcalot
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Flow Control
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="blue"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/arcalot/arcaflow-engine" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    arcalot/arcaflow-engine
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../" class="md-tabs__link">
          
  
    
  
  Arcaflow

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Arcalot" class="md-nav__button md-logo" aria-label="Arcalot" data-md-component="logo">
      
  <img src="../../../arcalot.svg" alt="logo">

    </a>
    Arcalot
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/arcalot/arcaflow-engine" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    arcalot/arcaflow-engine
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Arcaflow
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Arcaflow
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../concepts/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Concepts
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Concepts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/architecture/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Architecture
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/typing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Typing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/plugins/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Plugins
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/workflows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Workflows
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
          
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../running/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Running Arcaflow
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            Running Arcaflow
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../running/setup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Setting up Arcaflow
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../running/running/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Running a workflow
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
          
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../plugins/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Creating plugins
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            Creating plugins
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../plugins/python/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Python
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_5_3" id="__nav_2_5_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5_3">
            <span class="md-nav__icon md-icon"></span>
            Python
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../plugins/python/first/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Your first plugin
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../plugins/python/data-model/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Creating the plugin schema
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../plugins/python/embedding/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Embedding your plugin
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../plugins/python/testing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Testing your plugin
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../plugins/python/faq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Frequently asked questions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../plugins/python/schema/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Creating a schema by hand
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../plugins/python/official/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing official plugins
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
          
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../plugins/go/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Go
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_5_4" id="__nav_2_5_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_5_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5_4">
            <span class="md-nav__icon md-icon"></span>
            Go
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../plugins/go/first/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Your first plugin
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../plugins/go/schema/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Creating a schema
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../plugins/packaging/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Packaging plugins
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Writing workflows
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_6" id="__nav_2_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_6">
            <span class="md-nav__icon md-icon"></span>
            Writing workflows
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../versioning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Versioning
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../schemas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Workflow schemas
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../input/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Creating your input schema
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../step/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Setting up a step
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../expressions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Expressions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Flow Control
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Flow Control
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#conditional-step-execution" class="md-nav__link">
    <span class="md-ellipsis">
      Conditional Step Execution
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Conditional Step Execution">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graceful-handling-of-disabled-steps" class="md-nav__link">
    <span class="md-ellipsis">
      Graceful handling of disabled steps
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Graceful handling of disabled steps">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#how-to-do-this-in-a-workflow" class="md-nav__link">
    <span class="md-ellipsis">
      How to do this in a workflow
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-to-use-oneof" class="md-nav__link">
    <span class="md-ellipsis">
      How to use !oneof
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-to-use-ordisabled" class="md-nav__link">
    <span class="md-ellipsis">
      How to use !ordisabled
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alternative-methods" class="md-nav__link">
    <span class="md-ellipsis">
      Alternative methods
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Alternative methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#how-to-use-wait-optional" class="md-nav__link">
    <span class="md-ellipsis">
      How to use !wait-optional
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-to-use-soft-optional" class="md-nav__link">
    <span class="md-ellipsis">
      How to use !soft-optional
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#foreach-loops" class="md-nav__link">
    <span class="md-ellipsis">
      Foreach Loops
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Foreach Loops">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#reduce-repetition-with-bindconstants" class="md-nav__link">
    <span class="md-ellipsis">
      Reduce Repetition with bindConstants()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Reduce Repetition with bindConstants()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#workflow-and-input-before-bindconstants" class="md-nav__link">
    <span class="md-ellipsis">
      Workflow and Input Before bindConstants()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reduced-repetition-workflow" class="md-nav__link">
    <span class="md-ellipsis">
      Reduced Repetition Workflow
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../output/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Outputs
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_7" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../contributing/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Contributing
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_7" id="__nav_2_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_7">
            <span class="md-nav__icon md-icon"></span>
            Contributing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/typing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Typing system
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/plugin-protocol/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Arcaflow Transport Protocol
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/expressions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Expression language
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/deployers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Deployers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/engine/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Engine
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="using-flow-control-mechanics">Using Flow Control Mechanics</h1>
<p>Flow control allows the workflow author to build a workflow with a decision tree based on supported flow logic. These flow control operations are not implemented by plugins, but are part of the workflow engine itself.</p>
<h2 id="conditional-step-execution">Conditional Step Execution</h2>
<p>Conditional step execution can be achieved with the <code>enabled</code> input.</p>
<p>The value passed into the <code>enabled</code> field should be an expression that resolves as a boolean. So it should either reference a path to a boolean value, or it should be a binary comparison.</p>
<p>A situation that would benefit from conditional step execution includes a step that uploads the result to a remote server. For development runs you may not want to upload the results, so you can create a <code>bool</code> field in the input to toggle the upload, then you can reference that field in the <code>enabled</code> field of the upload step.</p>
<p>Example:
<div class="highlight"><span class="filename">workflow.yaml</span><pre><span></span><code><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v0.2.0</span>
<span class="nt">input</span><span class="p">:</span>
<span class="w">  </span><span class="nt">root</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RootObject</span>
<span class="w">  </span><span class="nt">objects</span><span class="p">:</span>
<span class="w">    </span><span class="nt">RootObject</span><span class="p">:</span>
<span class="w">      </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RootObject</span>
<span class="w">      </span><span class="nt">properties</span><span class="p">:</span>
<span class="w">        </span><span class="nt">step_1_enabled</span><span class="p">:</span>
<span class="w">          </span><span class="nt">type</span><span class="p">:</span>
<span class="w">            </span><span class="nt">type_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bool</span>
<span class="w">        </span><span class="nt">step_1_input</span><span class="p">:</span>
<span class="w">          </span><span class="nt">type</span><span class="p">:</span>
<span class="w">            </span><span class="nt">type_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">integer</span>
<span class="nt">steps</span><span class="p">:</span>
<span class="w">  </span><span class="nt">my_step</span><span class="p">:</span>
<span class="w">    </span><span class="nt">plugin</span><span class="p">:</span>
<span class="w">      </span><span class="nt">deployment_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">image</span>
<span class="w">      </span><span class="nt">src</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">path/to/my_plugin:1</span>
<span class="w">    </span><span class="nt">input</span><span class="p">:</span>
<span class="w">      </span><span class="nt">param_1</span><span class="p">:</span><span class="w"> </span><span class="kt">!expr</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$.input.step_1_input</span>
<span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="kt">!expr</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$.input.step_1_enabled</span>
<span class="nt">outputs</span><span class="p">:</span>
<span class="w">  </span><span class="nt">workflow_success</span><span class="p">:</span>
<span class="w">    </span><span class="nt">plugin_output</span><span class="p">:</span><span class="w"> </span><span class="kt">!expr</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$.steps.my_step.outputs.success</span>
</code></pre></div></p>
<p>But oh no! The workflow fails with the error <code>all outputs marked as unresolvable</code> when the step is disabled.
This happens because the workflow instructed the step not to run, and therefore the output <code>workflow_success</code>
cannot get the information it needs. See the next section for methods of handling this situation.</p>
<h4 id="graceful-handling-of-disabled-steps">Graceful handling of disabled steps</h4>
<p>When steps are disabled, they no longer emit their step output. To handle this, the workflow output (or a
following step) must have an OR dependency on both the step&rsquo;s disable output and on another step that has
opposite enable logic.
An OR dependency means that the step will resolve when any of the nodes it depends on resolve, unlike the
default AND logic that waits for all dependencies to resolve.</p>
<p>Here is a visual demonstrating two steps that have opposite logic:
<pre class="mermaid"><code>stateDiagram-v2
  classDef tag font-style:italic;
  classDef step font-weight:bold;

  state if_state &lt;&lt;choice&gt;&gt;
  Step1:::step: Step 1
  [*] --&gt; Step1
  Step1 --&gt; if_state
  Step2:::step: Step 2
  Step3:::step: Step 3
  if_state --&gt; Step2: !expr $.step1.output_1 == true
  if_state --&gt; Step3: !expr $.step1.output_1 == false
  oneof:::tag: !oneof
  Step2 --&gt; oneof
  Step3 --&gt; oneof
  oneof --&gt; [*]</code></pre></p>
<p>Here is a visual demonstrating utilizing the disabled output:
<pre class="mermaid"><code>stateDiagram-v2
  classDef tag font-style:italic;
  classDef step font-weight:bold;

  input
  [*] --&gt; Step1:::step
  input --&gt; Step1: !expr $.input.enabled
  or_disabled:::tag: !ordisabled
  Step1 --&gt; or_disabled: success
  Step1 --&gt; or_disabled: Disabled
  or_disabled --&gt; [*]</code></pre></p>
<p>The way this works is that either of the two paths can create a valid output, allowing the workflow to continue past
the disabled steps.</p>
<h5 id="how-to-do-this-in-a-workflow">How to do this in a workflow</h5>
<p>There are two tags that create the described OR dependency.</p>
<table>
<thead>
<tr>
<th>Tag</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>!oneof</code></td>
<td>A general use tag to depend on any of the inputs</td>
</tr>
<tr>
<td><code>!ordisabled</code></td>
<td>A special case of <code>!oneof</code> that automatically handles the disabled case</td>
</tr>
</tbody>
</table>
<h5 id="how-to-use-oneof">How to use <code>!oneof</code></h5>
<p>To use <code>!oneof</code> for graceful handling of disabled steps, the oneof should depend on ONE OF the success output and
the disabled output, which will output either the success output or the disabled output.</p>
<p>The oneof tag is a method of creating a schema <code>one_of_string</code> type from values present in the workflow.</p>
<p>The syntax of <code>!oneof</code> is:
- Following the tag <code>!oneof</code>, create a new YAML section (map) by starting an indented new line. That section should contain two properties:
  - discriminator: A string that specifies what the oneof discriminator should be. The discriminator specifies which option was emitted.
  - options: A YAML section (map) that contains all options. The keys are the discriminator values, and the values should be valid expressions.</p>
<p>Example:
<div class="highlight"><span class="filename">workflow.yaml</span><pre><span></span><code><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v0.2.0</span>
<span class="nt">input</span><span class="p">:</span>
<span class="w">  </span><span class="nt">root</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RootObject</span>
<span class="w">  </span><span class="nt">objects</span><span class="p">:</span>
<span class="w">    </span><span class="nt">RootObject</span><span class="p">:</span>
<span class="w">      </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RootObject</span>
<span class="w">      </span><span class="nt">properties</span><span class="p">:</span>
<span class="w">        </span><span class="nt">step_1_enabled</span><span class="p">:</span>
<span class="w">          </span><span class="nt">type</span><span class="p">:</span>
<span class="w">            </span><span class="nt">type_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bool</span>
<span class="w">        </span><span class="nt">step_1_input</span><span class="p">:</span>
<span class="w">          </span><span class="nt">type</span><span class="p">:</span>
<span class="w">            </span><span class="nt">type_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">integer</span>
<span class="nt">steps</span><span class="p">:</span>
<span class="w">  </span><span class="nt">my_step</span><span class="p">:</span>
<span class="w">    </span><span class="nt">plugin</span><span class="p">:</span>
<span class="w">      </span><span class="nt">deployment_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">image</span>
<span class="w">      </span><span class="nt">src</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">path/to/my_plugin:1</span>
<span class="w">    </span><span class="nt">input</span><span class="p">:</span>
<span class="w">      </span><span class="nt">param_1</span><span class="p">:</span><span class="w"> </span><span class="kt">!expr</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$.input.step_1_input</span>
<span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="kt">!expr</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$.input.step_1_enabled</span>
<span class="nt">outputs</span><span class="p">:</span>
<span class="w">  </span><span class="nt">workflow_success</span><span class="p">:</span>
<span class="w">    </span><span class="nt">plugin_output</span><span class="p">:</span><span class="w"> </span><span class="kt">!oneof</span>
<span class="w">      </span><span class="nt">discriminator</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">result</span>
<span class="w">      </span><span class="nt">options</span><span class="p">:</span>
<span class="w">        </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="kt">!expr</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$.steps.my_step.outputs.success</span>
<span class="w">        </span><span class="nt">disabled</span><span class="p">:</span><span class="w"> </span><span class="kt">!expr</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$.steps.my_step.disabled.output</span>
</code></pre></div></p>
<h5 id="how-to-use-ordisabled">How to use <code>!ordisabled</code></h5>
<p>Arcaflow provides workflow developers an easy way to handle disabled steps that is as simple as changing the
expression tag from <code>!expr</code> to <code>!ordisabled</code>.</p>
<p>This is a special case of <code>!oneof</code> with the discriminator set to <code>result</code>, and the options set to <code>enabled</code> and
<code>disabled</code>. The enabled output is the expression provided, and the disabled output is automatically generated from
the expression provided.</p>
<p>The input must be in one of the following formats:
- <code>$.steps.step_name.outputs</code>
- <code>steps.step_name.outputs</code>
- <code>$.steps.step_name.outputs.output_name</code>
- <code>steps.step_name.outputs.output_name</code>
- <code>$.steps.step_name.outputs.output_name.output_field</code>
- <code>steps.step_name.outputs.output_name.output_field</code></p>
<p>Using <code>!ordisabled</code>, the following example is otherwise equivalent to the prior example:
<div class="highlight"><span class="filename">workflow.yaml</span><pre><span></span><code><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v0.2.0</span>
<span class="nt">input</span><span class="p">:</span>
<span class="w">  </span><span class="nt">root</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RootObject</span>
<span class="w">  </span><span class="nt">objects</span><span class="p">:</span>
<span class="w">    </span><span class="nt">RootObject</span><span class="p">:</span>
<span class="w">      </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RootObject</span>
<span class="w">      </span><span class="nt">properties</span><span class="p">:</span>
<span class="w">        </span><span class="nt">step_1_enabled</span><span class="p">:</span>
<span class="w">          </span><span class="nt">type</span><span class="p">:</span>
<span class="w">            </span><span class="nt">type_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bool</span>
<span class="w">        </span><span class="nt">step_1_input</span><span class="p">:</span>
<span class="w">          </span><span class="nt">type</span><span class="p">:</span>
<span class="w">            </span><span class="nt">type_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">integer</span>
<span class="nt">steps</span><span class="p">:</span>
<span class="w">  </span><span class="nt">my_step</span><span class="p">:</span>
<span class="w">    </span><span class="nt">plugin</span><span class="p">:</span>
<span class="w">      </span><span class="nt">deployment_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">image</span>
<span class="w">      </span><span class="nt">src</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">path/to/my_plugin:1</span>
<span class="w">    </span><span class="nt">input</span><span class="p">:</span>
<span class="w">      </span><span class="nt">param_1</span><span class="p">:</span><span class="w"> </span><span class="kt">!expr</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$.input.step_1_input</span>
<span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="kt">!expr</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$.input.step_1_enabled</span>
<span class="nt">outputs</span><span class="p">:</span>
<span class="w">  </span><span class="nt">workflow_success</span><span class="p">:</span>
<span class="w">    </span><span class="nt">plugin_output</span><span class="p">:</span><span class="w"> </span><span class="kt">!ordisabled</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$.steps.my_step.outputs.success</span>
</code></pre></div></p>
<h4 id="alternative-methods">Alternative methods</h4>
<p>For handling disabled steps, <code>!oneof</code> and <code>!ordisabled</code> are the recommended methods because they cause output failure
when the step fails. However, if it is acceptable for the workflow to succeed when a step crashes, the optional tags
could be the right feature for your workflow.</p>
<p>The alterative methods are the &ldquo;optional&rdquo; family of expression tags. The <code>oneof</code> tags instructed the workflow to
build a <code>oneof_string</code> type with OR dependencies, requiring one of the options to have an output for the oneof to
resolve. Meanwhile, the &ldquo;optional&rdquo; family of tags can resolve without an output by utilizing optional object property
fields.</p>
<table>
<thead>
<tr>
<th>Tag</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>!wait-optional</code></td>
<td>The typical one that should be used. It will resolve either when the value becomes present, or when it is known that the value will not resolve.</td>
</tr>
<tr>
<td><code>!soft-optional</code></td>
<td>Not recommended for most use cases. It will not wait for the value to be ready. If the value is present, it will set the field. If it isn&rsquo;t, it will exclude it.</td>
</tr>
</tbody>
</table>
<h5 id="how-to-use-wait-optional">How to use <code>!wait-optional</code></h5>
<div class="highlight"><span class="filename">workflow.yaml</span><pre><span></span><code><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v0.2.0</span>
<span class="nt">input</span><span class="p">:</span>
<span class="w">  </span><span class="nt">root</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RootObject</span>
<span class="w">  </span><span class="nt">objects</span><span class="p">:</span>
<span class="w">    </span><span class="nt">RootObject</span><span class="p">:</span>
<span class="w">      </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RootObject</span>
<span class="w">      </span><span class="nt">properties</span><span class="p">:</span>
<span class="w">        </span><span class="nt">step_1_enabled</span><span class="p">:</span>
<span class="w">          </span><span class="nt">type</span><span class="p">:</span>
<span class="w">            </span><span class="nt">type_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bool</span>
<span class="w">        </span><span class="nt">step_1_input</span><span class="p">:</span>
<span class="w">          </span><span class="nt">type</span><span class="p">:</span>
<span class="w">            </span><span class="nt">type_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">integer</span>
<span class="nt">steps</span><span class="p">:</span>
<span class="w">  </span><span class="nt">my_step</span><span class="p">:</span>
<span class="w">    </span><span class="nt">plugin</span><span class="p">:</span>
<span class="w">      </span><span class="nt">deployment_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">image</span>
<span class="w">      </span><span class="nt">src</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">path/to/my_plugin:1</span>
<span class="w">    </span><span class="nt">input</span><span class="p">:</span>
<span class="w">      </span><span class="nt">param_1</span><span class="p">:</span><span class="w"> </span><span class="kt">!expr</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$.input.step_1_input</span>
<span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="kt">!expr</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$.input.step_1_enabled</span>
<span class="nt">outputs</span><span class="p">:</span>
<span class="w">  </span><span class="nt">workflow_success</span><span class="p">:</span>
<span class="w">    </span><span class="nt">plugin_output</span><span class="p">:</span><span class="w"> </span><span class="kt">!wait-optional</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$.steps.my_step.outputs.success</span>
</code></pre></div>
<p>If <code>my_step</code> is enabled and has an output, it will be present in the <code>plugin_output</code> field of the <code>workflow_success</code>
output. Otherwise, the <code>workflow_success</code> output will not include the <code>plugin_output</code> field. The output will wait
for the plugin to finish, if enabled.</p>
<h5 id="how-to-use-soft-optional">How to use <code>!soft-optional</code></h5>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This feature is not recommended for most use cases.</p>
</div>
<p>The <code>!soft-optional</code> tag creates the loosest type of dependency. The output will <strong>not</strong> wait for the step to finish
or fail. In the event that the step referenced with the <code>!soft-optional</code> tag does not finish by the time the other
dependencies resolve, or if it crashes or is disabled, the field will be left out of the output.</p>
<p>The example used in <code>!wait-optional</code> would not work with <code>!soft-optional</code> because the output would immediately
resolve without the <code>plugin_output</code> field. A second dependency is required to ensure the output does not resolve immediately.</p>
<div class="highlight"><span class="filename">workflow.yaml</span><pre><span></span><code><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v0.2.0</span>
<span class="nt">input</span><span class="p">:</span>
<span class="w">  </span><span class="nt">root</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RootObject</span>
<span class="w">  </span><span class="nt">objects</span><span class="p">:</span>
<span class="w">    </span><span class="nt">RootObject</span><span class="p">:</span>
<span class="w">      </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RootObject</span>
<span class="w">      </span><span class="nt">properties</span><span class="p">:</span>
<span class="w">        </span><span class="nt">background_step_enabled</span><span class="p">:</span>
<span class="w">          </span><span class="nt">type</span><span class="p">:</span>
<span class="w">            </span><span class="nt">type_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bool</span>
<span class="w">        </span><span class="nt">background_step_input</span><span class="p">:</span>
<span class="w">          </span><span class="nt">type</span><span class="p">:</span>
<span class="w">            </span><span class="nt">type_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">integer</span>
<span class="w">        </span><span class="nt">step_1_input</span><span class="p">:</span>
<span class="w">          </span><span class="nt">type</span><span class="p">:</span>
<span class="w">            </span><span class="nt">type_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">integer</span>
<span class="nt">steps</span><span class="p">:</span>
<span class="w">  </span><span class="nt">background_step</span><span class="p">:</span>
<span class="w">    </span><span class="nt">plugin</span><span class="p">:</span>
<span class="w">      </span><span class="nt">deployment_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">image</span>
<span class="w">      </span><span class="nt">src</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">path/to/my_background_plugin:1</span>
<span class="w">    </span><span class="nt">input</span><span class="p">:</span>
<span class="w">      </span><span class="nt">param_1</span><span class="p">:</span><span class="w"> </span><span class="kt">!expr</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$.input.background_step_input</span>
<span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="kt">!expr</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$.input.background_step_enabled</span>
<span class="w">  </span><span class="nt">my_step</span><span class="p">:</span>
<span class="w">    </span><span class="nt">plugin</span><span class="p">:</span>
<span class="w">      </span><span class="nt">deployment_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">image</span>
<span class="w">      </span><span class="nt">src</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">path/to/my_plugin:1</span>
<span class="w">    </span><span class="nt">input</span><span class="p">:</span>
<span class="w">      </span><span class="nt">param_1</span><span class="p">:</span><span class="w"> </span><span class="kt">!expr</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$.input.step_1_input</span>
<span class="nt">outputs</span><span class="p">:</span>
<span class="w">  </span><span class="nt">workflow_success</span><span class="p">:</span>
<span class="w">    </span><span class="nt">background_output</span><span class="p">:</span><span class="w"> </span><span class="kt">!soft-optional</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$.steps.background_step.outputs.success</span>
<span class="w">    </span><span class="nt">plugin_output</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$.steps.my_step.outputs.success</span>
</code></pre></div>
<h2 id="foreach-loops">Foreach Loops</h2>
<p>Foreach loops allow for running a sub-workflow with iterative inputs from a parent workflow. A sub-workflow is a complete Arcaflow workflow file with its own input and output schemas as described in this section. The inputs for the sub-workflow are provided as a list, where each list item is an object that matches the sub-workflow input schema.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>A complete functional example is available in the <a href="https://github.com/arcalot/arcaflow-workflows/tree/main/examples/sub-workflow-foreach">arcaflow-workflows</a> repository.</p>
</div>
<p>In the parent workflow file, the author can define an input schema with the list that will contain the input object that will be passed to the sub-workflow. For example:</p>
<div class="highlight"><span class="filename">workflow.yaml</span><pre><span></span><code><span class="nt">input</span><span class="p">:</span>
<span class="w">  </span><span class="nt">root</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RootObject</span>
<span class="w">  </span><span class="nt">objects</span><span class="p">:</span>
<span class="w">    </span><span class="nt">RootObject</span><span class="p">:</span>
<span class="w">      </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RootObject</span>
<span class="w">      </span><span class="nt">properties</span><span class="p">:</span>
<span class="w">        </span><span class="nt">loop</span><span class="p">:</span>
<span class="w">          </span><span class="nt">type</span><span class="p">:</span>
<span class="w">            </span><span class="nt">type_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">list</span>
<span class="w">            </span><span class="nt">items</span><span class="p">:</span>
<span class="w">              </span><span class="nt">type_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">object</span>
<span class="w">              </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">loop_id</span>
<span class="w">              </span><span class="nt">properties</span><span class="p">:</span>
<span class="w">                </span><span class="nt">loop_id</span><span class="p">:</span>
<span class="w">                  </span><span class="nt">type</span><span class="p">:</span>
<span class="w">                    </span><span class="nt">type_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">integer</span>
<span class="w">                </span><span class="nt">param_1</span><span class="p">:</span>
<span class="w">                  </span><span class="nt">type</span><span class="p">:</span>
<span class="w">                    </span><span class="nt">type_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">integer</span>
<span class="w">                </span><span class="nt">param_2</span><span class="p">:</span>
<span class="w">                  </span><span class="nt">type</span><span class="p">:</span>
<span class="w">                    </span><span class="nt">type_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
</code></pre></div>
<p>Then in the <code>steps</code> section of the workflow, the sub-workflow can be defined as a step with the <code>loop</code> list object from above passed to its input.</p>
<p>The parameters for the sub-workflow step are:</p>
<ul>
<li><code>kind</code> - The type of loop (currently only foreach is supported)</li>
<li><code>items</code> - A list of objects to pass to the sub-workflow (the <a href="../expressions/">expression language</a> allows to pass this from the input schema per the above example)</li>
<li><code>workflow</code> - The file name for the sub-workflow (this should be in the same directory as the parent workflow)</li>
<li><code>parallelism</code> - The number of sub-workflow loop iterations that will run in parallel</li>
</ul>
<div class="highlight"><span class="filename">workflow.yaml</span><pre><span></span><code><span class="nt">steps</span><span class="p">:</span>
<span class="w">  </span><span class="nt">sub_workflow_loop</span><span class="p">:</span>
<span class="w">    </span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">foreach</span>
<span class="w">    </span><span class="nt">items</span><span class="p">:</span><span class="w"> </span><span class="kt">!expr</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$.input.loop</span>
<span class="w">    </span><span class="nt">workflow</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sub-workflow.yaml</span>
<span class="w">    </span><span class="nt">parallelism</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
</code></pre></div>
<p>The input yaml file for the above parent workflow would provide the list of objects to loop over as in this example:</p>
<div class="highlight"><span class="filename">input.yaml</span><pre><span></span><code><span class="nt">loop</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">loop_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">    </span><span class="nt">param_1</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
<span class="w">    </span><span class="nt">param_2</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;a&quot;</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">loop_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="w">    </span><span class="nt">param_1</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">20</span>
<span class="w">    </span><span class="nt">param_2</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;b&quot;</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">loop_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
<span class="w">    </span><span class="nt">param_1</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">30</span>
<span class="w">    </span><span class="nt">param_2</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;c&quot;</span>
</code></pre></div>
<p>The sub-workflow file then has its complete schema and set of steps as in this example:</p>
<div class="highlight"><span class="filename">sub-workflow.yaml</span><pre><span></span><code><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v0.2.0</span>
<span class="nt">input</span><span class="p">:</span>
<span class="w">  </span><span class="nt">root</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RootObject</span>
<span class="w">  </span><span class="nt">objects</span><span class="p">:</span>
<span class="w">    </span><span class="nt">RootObject</span><span class="p">:</span>
<span class="w">      </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RootObject</span>
<span class="w">      </span><span class="nt">properties</span><span class="p">:</span>
<span class="w">        </span><span class="nt">loop_id</span><span class="p">:</span>
<span class="w">          </span><span class="nt">type</span><span class="p">:</span>
<span class="w">            </span><span class="nt">type_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">integer</span>
<span class="w">        </span><span class="nt">param_1</span><span class="p">:</span>
<span class="w">          </span><span class="nt">type</span><span class="p">:</span>
<span class="w">            </span><span class="nt">type_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">integer</span>
<span class="w">        </span><span class="nt">param_2</span><span class="p">:</span>
<span class="w">          </span><span class="nt">type</span><span class="p">:</span>
<span class="w">            </span><span class="nt">type_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<span class="nt">steps</span><span class="p">:</span>
<span class="w">  </span><span class="nt">my_plugin</span><span class="p">:</span>
<span class="w">    </span><span class="nt">plugin</span><span class="p">:</span>
<span class="w">      </span><span class="nt">deployment_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">image</span>
<span class="w">      </span><span class="nt">src</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">path/to/my_plugin:1</span>
<span class="w">    </span><span class="nt">input</span><span class="p">:</span>
<span class="w">      </span><span class="nt">param_1</span><span class="p">:</span><span class="w"> </span><span class="kt">!expr</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$.input.param_1</span>
<span class="w">  </span><span class="nt">my_other_plugin</span><span class="p">:</span>
<span class="w">    </span><span class="nt">plugin</span><span class="p">:</span>
<span class="w">      </span><span class="nt">deployment_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">image</span>
<span class="w">      </span><span class="nt">src</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">path/to/my_other_plugin:1</span>
<span class="w">    </span><span class="nt">input</span><span class="p">:</span>
<span class="w">      </span><span class="nt">param_2</span><span class="p">:</span><span class="w"> </span><span class="kt">!expr</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$.input.param_2</span>
<span class="nt">outputs</span><span class="p">:</span>
<span class="w">  </span><span class="nt">success</span><span class="p">:</span>
<span class="w">    </span><span class="nt">loop_id</span><span class="p">:</span><span class="w"> </span><span class="kt">!expr</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$.input.loop_id</span>
<span class="w">    </span><span class="nt">my_plugin</span><span class="p">:</span><span class="w"> </span><span class="kt">!expr</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$.steps.my_plugin.outputs.success</span>
<span class="w">    </span><span class="nt">my_other_plugin</span><span class="p">:</span><span class="w"> </span><span class="kt">!expr</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$.steps.my_other_plugin.outputs.success</span>
</code></pre></div>
<h3 id="reduce-repetition-with-bindconstants">Reduce Repetition with <code>bindConstants()</code></h3>
<p>The builtin function <a href="../expressions/#functions"><code>bindConstants()</code></a> allows you to
avoid repeating input variables for a <code>foreach</code> subworkflow. In the example
below, the input variable <code>name</code>&rsquo;s value is repeated across each iteration in
this input. This results in a more repetitive input and schema definition. This
section will show you how to simplify it.</p>
<h4 id="workflow-and-input-before-bindconstants">Workflow and Input Before <code>bindConstants()</code></h4>
<div class="highlight"><span class="filename">input-repeated.yaml</span><pre><span></span><code><span class="nt">iterations</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">loop_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">    </span><span class="nt">repeated_inputs</span><span class="p">:</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mogo</span>
<span class="w">      </span><span class="nt">ratio</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3.14</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">loop_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="w">    </span><span class="nt">repeated_inputs</span><span class="p">:</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mogo</span>
<span class="w">      </span><span class="nt">ratio</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3.14</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">loop_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
<span class="w">    </span><span class="nt">repeated_inputs</span><span class="p">:</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mogo</span>
<span class="w">      </span><span class="nt">ratio</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3.14</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">loop_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4</span>
<span class="w">    </span><span class="nt">repeated_inputs</span><span class="p">:</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mogo</span>
<span class="w">      </span><span class="nt">ratio</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3.14</span>
</code></pre></div>
<div class="highlight"><span class="filename">workflow.yaml</span><pre><span></span><code><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v0.2.0</span>
<span class="nt">input</span><span class="p">:</span>
<span class="w">  </span><span class="nt">root</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RootObject</span>
<span class="w">  </span><span class="nt">objects</span><span class="p">:</span>
<span class="w">    </span><span class="nt">RootObject</span><span class="p">:</span>
<span class="w">      </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RootObject</span>
<span class="w">      </span><span class="nt">properties</span><span class="p">:</span>
<span class="w">        </span><span class="nt">iterations</span><span class="p">:</span>
<span class="w">          </span><span class="nt">type</span><span class="p">:</span>
<span class="w">            </span><span class="nt">type_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">list</span>
<span class="w">            </span><span class="nt">items</span><span class="p">:</span>
<span class="w">              </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SubRootObject</span>
<span class="w">              </span><span class="nt">type_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ref</span>
<span class="w">              </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$.steps.foreach_loop.execute.inputs.items</span>

<span class="nt">steps</span><span class="p">:</span>
<span class="w">  </span><span class="nt">foreach_loop</span><span class="p">:</span>
<span class="w">    </span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">foreach</span>
<span class="w">    </span><span class="nt">items</span><span class="p">:</span><span class="w"> </span><span class="kt">!expr</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$.input.iterations</span>
<span class="w">    </span><span class="nt">workflow</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">subworkflow.yaml</span>
<span class="w">    </span><span class="nt">parallelism</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>

<span class="nt">outputs</span><span class="p">:</span>
<span class="w">  </span><span class="nt">success</span><span class="p">:</span>
<span class="w">    </span><span class="nt">fab_four</span><span class="p">:</span><span class="w"> </span><span class="kt">!expr</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$.steps.foreach_loop.outputs.success.data</span>
</code></pre></div>
<div class="highlight"><span class="filename">subworkflow.yaml</span><pre><span></span><code><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v0.2.0</span>
<span class="nt">input</span><span class="p">:</span>
<span class="w">  </span><span class="nt">root</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SubRootObject</span>
<span class="w">  </span><span class="nt">objects</span><span class="p">:</span>
<span class="w">    </span><span class="nt">SubRootObject</span><span class="p">:</span>
<span class="w">      </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SubRootObject</span>
<span class="w">      </span><span class="nt">properties</span><span class="p">:</span>
<span class="w">        </span><span class="nt">loop_id</span><span class="p">:</span>
<span class="w">          </span><span class="nt">type</span><span class="p">:</span>
<span class="w">            </span><span class="nt">type_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">integer</span>
<span class="w">        </span><span class="nt">repeated_inputs</span><span class="p">:</span>
<span class="w">          </span><span class="nt">type</span><span class="p">:</span>
<span class="w">            </span><span class="nt">type_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ref</span>
<span class="w">            </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RepeatedInputs</span>
<span class="w">    </span><span class="nt">RepeatedInputs</span><span class="p">:</span>
<span class="w">      </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RepeatedInputs</span>
<span class="w">      </span><span class="nt">properties</span><span class="p">:</span>
<span class="w">        </span><span class="nt">name</span><span class="p">:</span>
<span class="w">          </span><span class="nt">type</span><span class="p">:</span>
<span class="w">            </span><span class="nt">type_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<span class="w">        </span><span class="nt">ratio</span><span class="p">:</span>
<span class="w">          </span><span class="nt">type</span><span class="p">:</span>
<span class="w">            </span><span class="nt">type_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">float</span>

<span class="nt">steps</span><span class="p">:</span>
<span class="w">  </span><span class="nt">example</span><span class="p">:</span>
<span class="w">    </span><span class="nt">plugin</span><span class="p">:</span>
<span class="w">      </span><span class="nt">deployment_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">image</span>
<span class="w">      </span><span class="nt">src</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">quay.io/arcalot/arcaflow-plugin-template-python:0.4.0</span>
<span class="w">    </span><span class="nt">input</span><span class="p">:</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="kt">!expr</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$.input.repeated_inputs.name</span>

<span class="nt">outputs</span><span class="p">:</span>
<span class="w">  </span><span class="nt">success</span><span class="p">:</span>
<span class="w">    </span><span class="nt">loop_id</span><span class="p">:</span><span class="w"> </span><span class="kt">!expr</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$.input.loop_id</span>
<span class="w">    </span><span class="nt">ratio</span><span class="p">:</span><span class="w"> </span><span class="kt">!expr</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$.input.repeated_inputs.ratio</span>
<span class="w">    </span><span class="nt">beatle</span><span class="p">:</span><span class="w"> </span><span class="kt">!expr</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$.steps.example.outputs.success</span>
</code></pre></div>
<h4 id="reduced-repetition-workflow">Reduced Repetition Workflow</h4>
<p>Here we restructure the input, factoring out the repeated <code>name</code> and <code>ratio</code> 
entries in the list and placing them into a single field; we will use 
<code>bindConstants()</code> to construct the <code>foreach</code> list with repeated entries.</p>
<div class="highlight"><span class="filename">input.yaml</span><pre><span></span><code><span class="nt">repeated_inputs</span><span class="p">:</span><span class="w"> </span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mogo</span>
<span class="w">  </span><span class="nt">ratio</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3.14</span>
<span class="nt">iterations</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">loop_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">loop_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">loop_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">loop_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4</span>
</code></pre></div>
<p>To use the generated values from <code>bindConstants()</code>, a new schema representing 
these bound values must be added to the input schema section of our 
<code>subworkflow.yaml</code>, <code>input</code>. This new schema&rsquo;s ID will be the ID of the schema 
that defines the items in your list, in this case <code>SubRootObject</code> and the 
schema name that defines your repeated inputs, in this case <code>RepeatedValues</code>, 
for more information see 
<a href="../schemas/#generated-combined-schema-names">Generated Schema Names</a>. This 
creates our new schema ID, <code>SubRootObject__RepeatedValues</code>. You are required 
to use this schema ID because it is generated from the names of your other 
schemas.</p>
<div class="highlight"><span class="filename">workflow.yaml</span><pre><span></span><code><span class="nt">steps</span><span class="p">:</span>
<span class="w">  </span><span class="nt">foreach_loop</span><span class="p">:</span>
<span class="w">    </span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">foreach</span>
<span class="w">    </span><span class="nt">items</span><span class="p">:</span><span class="w"> </span><span class="kt">!expr</span><span class="w"> </span><span class="s">&#39;bindConstants($.input.iterations,</span><span class="nv"> </span><span class="s">$.input.repeated_inputs)&#39;</span>
<span class="w">    </span><span class="nt">workflow</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">subworkflow.yaml</span>
<span class="w">    </span><span class="nt">parallelism</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
</code></pre></div>
<p>To use <code>bindConstants()</code> with an <code>outputSchema</code> in your workflow, you need to 
reference the schema of the list items returned by <code>bindConstants()</code>, see 
<a href="../schemas/#generated-combined-schema-names">Generated Schema Name</a>.</p>
<p>See the <a href="https://github.com/arcalot/arcaflow-workflows/blob/492e30ffbea6ce902e6e7ec050c4d1be307b6d73/basic-examples/bind-constants/workflow.yaml#L28">full workflow</a>.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/arcalot" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.instant", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.indexes", "toc.integrate", "search.suggest", "search.highlight", "search.share", "content.code.copy"], "search": "../../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
    
  </body>
</html>